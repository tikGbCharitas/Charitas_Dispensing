@model List<AvicennaDispensing.ViewModels.BinTransferViewModel.BinItemDetailGrouped>

@{
    var CommonLocalizer = Factory.Create("Views.Shared.Common", Assembly.GetExecutingAssembly().GetName().Name!);
    var IndexLocalizer = Factory.Create("Views.BinTransfer.Index", Assembly.GetExecutingAssembly().GetName().Name!);
}

@if (Model == null || !Model.Any())
{
    <div class="alert alert-warning">@CommonLocalizer["NoItem"]</div>
}
else
{
    <span class="text-muted">@IndexLocalizer["Found"] : @Model.Count() @Localizer["item(s)"]</span>

    @foreach (var item in Model)
    {
        <div class="item-card wizard-item-card" data-item-id="@item.ItemID">
            <div class="row align-items-center">
                <div class="col-auto">
                    <input type="checkbox" class="wizard-item-checkbox form-check-input" 
                           data-item-id="@item.ItemID"
                           data-item-name="@item.ItemName"
                           data-total-quantity="@item.TotalQuantity.ToString(CultureInfo.InvariantCulture)"
                           data-variant-count="@item.VariantCount.ToString(CultureInfo.InvariantCulture)">
                </div>
                <div class="col">
                    <h6 class="mb-1">@Html.HighlightSearch(item.ItemName)</h6>
                    <small class="text-muted">
                        <span class="badge bg-secondary">@Html.HighlightSearch(item.ItemID)</span>
                        <span class="badge bg-info">@item.VariantCount.ToString(CultureInfo.InvariantCulture) variant(s)</span>
                    </small>
                </div>
                <div class="col-auto text-end">
                    <div class="badge bg-success fs-6">@item.TotalQuantity.ToString(CultureInfo.InvariantCulture)</div>
                    @* <button type="button" class="btn btn-sm btn-outline-info ms-2 btn-show-variants" 
                            data-item-id="@item.ItemID">
                        <i class="bi bi-eye"></i>
                    </button> *@
                </div>
            </div>
            
            <!-- Variants Detail (Hidden by default) -->
            @* <div class="variants-detail mt-2" id="variants-@item.ItemID" style="display: none;">
                <div class="table-responsive">
                    <table class="table table-sm table-bordered mb-0">
                        <thead class="table-light">
                            <tr>
                                <th>Batch</th>
                                <th>NIE BPOM</th>
                                <th>Expired</th>
                                <th>Qty</th>
                            </tr>
                        </thead>
                        <tbody>
                            @foreach (var variant in item.Variants)
                            {
                                <tr>
                                    <td>@variant.BatchID</td>
                                    <td>@variant.NIE_BPOM</td>
                                    <td>@variant.ExpiredDate</td>
                                    <td><span class="badge bg-primary">@variant.Quantity</span></td>
                                </tr>
                            }
                        </tbody>
                    </table>
                </div>
            </div> *@
        </div>
    }
}
